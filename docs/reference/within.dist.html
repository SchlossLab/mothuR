<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculating distances within groups — within.dist • mothuR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Calculating distances within groups — within.dist" />
<meta property="og:description" content="Imports a distance matrix and a '.design' file, and uses them to return statistics about the distances within each designated group.  Prints statistics and when asigned to a variable, returns a list of the distances within each group to be used for further analysis." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mothuR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculating distances within groups</h1>
    
    <div class="hidden name"><code>within.dist.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Imports a distance matrix and a '.design' file, and uses them to return statistics about the distances within each designated group.  Prints statistics and when asigned to a variable, returns a list of the distances within each group to be used for further analysis.</p>
    </div>

    <pre class="usage"><span class='fu'>within.dist</span>(<span class='no'>dist</span>, <span class='no'>design</span>, <span class='no'>groups</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dist</th>
      <td><p>Either a file containing a phylip formatted distance matrix with ThetaYC, UniFrac, or some other distance metric between samples or a variable representing the distance matrix that was imported using the read.dist function.</p></td>
    </tr>
    <tr>
      <th>design</th>
      <td><p>'.design' file, i.e. a file containing two columns separated by a tab, with the sample names in the left column and the name of their group in the right column</p></td>
    </tr>
    <tr>
      <th>groups</th>
      <td><p>a vector of strings containing the names of the groups to be analyzed.  There is no limit to the number of groups that can be analyzed.  The parameter 'all' can be used to analyze the relationships between all groups.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>If the dist paramater is a phylip file, then the function will start by using the read.dist function to import the distance matrix.  The function will then parse distance matrix into smaller matrices each containing the columns and rows of each group.  The distances in each of the smaller matrices are then used to calculated the minimum, maximum, median, mean, and standard deviation of the distances within each group.  The statistics are printed to the screen.</p>	
<p>When assigned to a variable, the function will output a list of vectors,  each containing all of the distances between the two groups.  The vectors in the list are named based on the name of the group.  This list output can used for further statistical analysis of the distances, such as a Wilcoxon test, or can be input in the plot.dists function to make a barplot of the distances.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><!-- %%  ~Describe the value returned -->
<!-- %%  If it is a LIST, use -->
<!-- %%  \item{comp1 }{Description of 'comp1'} -->
<!-- %%  \item{comp2 }{Description of 'comp2'} -->
<!-- %% ... --></p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p><!-- %% ~put references to the literature/web site here ~ --></p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Since the output of this function is a list, pulling out a vector from the list is done using my.list[[1]].  To get a single distance assign my.list[[1]] to a variable (i.e. vect1&lt;-my.list[[1]]) then specify the component of the list using vect1[1].  There's probably also an easier way to do this, but I haven't figured it out.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>between.dist for calculating distances between groups
plot.dist for plotting the output from of between.dist and within.dist</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#Using a phylip file as input</span>
        <span class='co'>#within.dist('~/Desktop/germfree.sq.dist','~/Desktop/germfree.design', c('early','late'))</span>

        <span class='co'>#Using a distance matrix that has already been read in using read.dist</span>
        <span class='co'>#within.dist(gf.dist,'~/Desktop/germfree.design', c('early','late'))</span>

        <span class='co'>#Calculating distances between combinations of groups</span>
        <span class='co'>#within.dist('~/Desktop/germfree.sq.dist','~/Desktop/germfree.design', 'all')</span>

        <span class='co'>#Plotting the output</span>
        <span class='co'>#wtn.list&lt;-within.dist('~/Desktop/germfree.sq.dist','~/Desktop/germfree.design', c('early','late'))</span>
        <span class='co'>#plot.dist(wtn.list)</span>


<span class='co'>## The function is currently defined as</span>
<span class='kw'>function</span> (<span class='no'>dist</span>, <span class='no'>design</span>, <span class='no'>groups</span>)
{
    <span class='kw'>if</span> (<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>groups</span>) <span class='kw'>==</span> <span class='fl'>1</span>) {
        <span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span>(<span class='kw'>warn</span> <span class='kw'>=</span> (-<span class='fl'>1</span>))
        <span class='kw'>if</span> (<span class='no'>groups</span> <span class='kw'>==</span> <span class='st'>"all"</span>) {
            <span class='kw'>if</span> (<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>design</span>) <span class='kw'>==</span> <span class='fl'>1</span>) {
                <span class='no'>dsn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.table</a></span>(<span class='no'>design</span>)
            }
            <span class='kw'>if</span> (<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>design</span>) <span class='kw'>&gt;</span> <span class='fl'>1</span>) {
                <span class='no'>dsn</span> <span class='kw'>&lt;-</span> <span class='no'>design</span>
            }
            <span class='no'>groups</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>as.vector</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span>(<span class='no'>dsn</span>[, <span class='fl'>2</span>]))
            <span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span>(<span class='kw'>warn</span> <span class='kw'>=</span> (<span class='fl'>0</span>))
        }
    }
    <span class='no'>one.within</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>dist</span>, <span class='no'>design</span>, <span class='no'>group</span>) {
        <span class='kw'>if</span> (<span class='fu'><a href='https://rdrr.io/r/base/typeof.html'>typeof</a></span>(<span class='no'>dist</span>) <span class='kw'>==</span> <span class='st'>"character"</span>) {
            <span class='no'>dist</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='read.dist.html'>read.dist</a></span>(<span class='no'>dist</span>)
        }
        <span class='kw'>if</span> (<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>design</span>) <span class='kw'>==</span> <span class='fl'>1</span>) {
            <span class='no'>design</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='read.design.html'>read.design</a></span>(<span class='no'>design</span>)
        }
        <span class='no'>get.dists</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>dist</span>, <span class='no'>design</span>, <span class='no'>group1</span>, <span class='no'>group2</span>) {
            <span class='no'>get.grp1</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>d</span>, <span class='no'>g</span>) {
                <span class='no'>c1</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>
                <span class='no'>grp1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>()
                <span class='kw'>for</span> (<span class='no'>i</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>d</span>)) {
                  <span class='kw'>if</span> (<span class='no'>d</span>[<span class='no'>i</span>, <span class='fl'>2</span>] <span class='kw'>==</span> <span class='no'>g</span>) {
                    <span class='no'>grp1</span>[<span class='no'>c1</span>] <span class='kw'>&lt;-</span> <span class='no'>d</span>[<span class='no'>i</span>, <span class='fl'>1</span>]
                    <span class='no'>c1</span> <span class='kw'>&lt;-</span> <span class='no'>c1</span> + <span class='fl'>1</span>
                  }
                }
                <span class='fu'><a href='https://rdrr.io/r/base/invisible.html'>invisible</a></span>(<span class='no'>grp1</span>)
            }
            <span class='no'>get.grp2</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>d</span>, <span class='no'>g</span>) {
                <span class='no'>c2</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>
                <span class='no'>grp2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>()
                <span class='kw'>for</span> (<span class='no'>i</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>d</span>)) {
                  <span class='kw'>if</span> (<span class='no'>d</span>[<span class='no'>i</span>, <span class='fl'>2</span>] <span class='kw'>==</span> <span class='no'>g</span>) {
                    <span class='no'>grp2</span>[<span class='no'>c2</span>] <span class='kw'>&lt;-</span> <span class='no'>d</span>[<span class='no'>i</span>, <span class='fl'>1</span>]
                    <span class='no'>c2</span> <span class='kw'>&lt;-</span> <span class='no'>c2</span> + <span class='fl'>1</span>
                  }
                }
                <span class='fu'><a href='https://rdrr.io/r/base/invisible.html'>invisible</a></span>(<span class='no'>grp2</span>)
            }
            <span class='no'>grp1</span> <span class='kw'>&lt;-</span> <span class='fu'>get.grp1</span>(<span class='no'>design</span>, <span class='no'>group1</span>)
            <span class='no'>grp2</span> <span class='kw'>&lt;-</span> <span class='fu'>get.grp2</span>(<span class='no'>design</span>, <span class='no'>group2</span>)
            <span class='no'>get.rows</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>dist</span>, <span class='no'>grp</span>) {
                <span class='no'>rows</span> <span class='kw'>&lt;-</span> <span class='no'>dist</span>[<span class='no'>grp</span>[<span class='fl'>1</span>], ]
                <span class='kw'>for</span> (<span class='no'>i</span> <span class='kw'>in</span> <span class='fl'>2</span>:<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>grp</span>)) {
                  <span class='no'>rows</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>(<span class='no'>rows</span>, <span class='no'>dist</span>[<span class='no'>grp</span>[<span class='no'>i</span>], ])
                }
                <span class='fu'><a href='https://rdrr.io/r/base/invisible.html'>invisible</a></span>(<span class='no'>rows</span>)
            }
            <span class='no'>rows</span> <span class='kw'>&lt;-</span> <span class='fu'>get.rows</span>(<span class='no'>dist</span>, <span class='no'>grp1</span>)
            <span class='no'>get.rows</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>dist</span>, <span class='no'>grp</span>) {
                <span class='no'>matrix</span> <span class='kw'>&lt;-</span> <span class='no'>dist</span>[, <span class='no'>grp</span>[<span class='fl'>1</span>]]
                <span class='kw'>for</span> (<span class='no'>i</span> <span class='kw'>in</span> <span class='fl'>2</span>:<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>grp</span>)) {
                  <span class='no'>matrix</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='no'>matrix</span>, <span class='no'>dist</span>[, <span class='no'>grp</span>[<span class='no'>i</span>]])
                }
                <span class='fu'><a href='https://rdrr.io/r/base/invisible.html'>invisible</a></span>(<span class='no'>matrix</span>)
            }
            <span class='no'>matrix</span> <span class='kw'>&lt;-</span> <span class='fu'>get.rows</span>(<span class='no'>rows</span>, <span class='no'>grp2</span>)
            <span class='no'>vect</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>as.vector</a></span>(<span class='no'>matrix</span>)
            <span class='fu'><a href='https://rdrr.io/r/base/invisible.html'>invisible</a></span>(<span class='no'>vect</span>)
        }
        <span class='no'>dists</span> <span class='kw'>&lt;-</span> <span class='fu'>get.dists</span>(<span class='no'>dist</span>, <span class='no'>design</span>, <span class='no'>group</span>, <span class='no'>group</span>)
        <span class='no'>rm.duplicates</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>dists</span>) {
            <span class='no'>square</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='no'>dists</span>, <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>dists</span>)))
            <span class='no'>half.dists</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>()
            <span class='no'>half.dists</span>[<span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='no'>square</span>[<span class='fl'>2</span>, <span class='fl'>1</span>]
            <span class='kw'>for</span> (<span class='no'>i</span> <span class='kw'>in</span> <span class='fl'>3</span>:<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>square</span>)) {
                <span class='no'>keepers</span> <span class='kw'>&lt;-</span> <span class='no'>square</span>[<span class='no'>i</span>, <span class='fl'>1</span>:(<span class='no'>i</span> - <span class='fl'>1</span>)]
                <span class='no'>half.dists</span>[(<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>half.dists</span>) + <span class='fl'>1</span>):(<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>half.dists</span>) +
                  <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>keepers</span>))] <span class='kw'>&lt;-</span> <span class='no'>keepers</span>
            }
            <span class='fu'><a href='https://rdrr.io/r/base/invisible.html'>invisible</a></span>(<span class='no'>half.dists</span>)
        }
        <span class='no'>lt.dist</span> <span class='kw'>&lt;-</span> <span class='fu'>rm.duplicates</span>(<span class='no'>dists</span>)
        <span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span>(<span class='st'>"Stats for distances within %s"</span>, <span class='no'>group</span>),
            <span class='st'>"\n"</span>, <span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span>(<span class='st'>"Minimum: %f"</span>, <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span>(<span class='no'>lt.dist</span>)), <span class='st'>"\n"</span>,
            <span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span>(<span class='st'>"Maximum: %f"</span>, <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span>(<span class='no'>lt.dist</span>)), <span class='st'>"\n"</span>, <span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span>(<span class='st'>"Median: %f"</span>,
                <span class='fu'><a href='https://rdrr.io/r/stats/median.html'>median</a></span>(<span class='no'>lt.dist</span>)), <span class='st'>"\n"</span>, <span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span>(<span class='st'>"Mean: %f"</span>, <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span>(<span class='no'>lt.dist</span>)),
            <span class='st'>"\n"</span>, <span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span>(<span class='st'>"Std. Dev.: %f"</span>, <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span>(<span class='no'>lt.dist</span>)), <span class='st'>"\n"</span>,
            <span class='st'>"\n"</span>, <span class='kw'>sep</span> <span class='kw'>=</span> <span class='st'>""</span>)
        <span class='fu'><a href='https://rdrr.io/r/base/invisible.html'>invisible</a></span>(<span class='no'>lt.dist</span>)
    }
    <span class='no'>dist.vect</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>()
    <span class='no'>c</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>
    <span class='no'>dist.list</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>vector</a></span>(<span class='kw'>mode</span> <span class='kw'>=</span> <span class='st'>"list"</span>, <span class='kw'>length</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>groups</span>))
    <span class='kw'>for</span> (<span class='no'>i</span> <span class='kw'>in</span> <span class='no'>groups</span>) {
        <span class='no'>dist.list</span><span class='kw'>[[</span><span class='no'>c</span>]] <span class='kw'>&lt;-</span> <span class='fu'>one.within</span>(<span class='no'>dist</span>, <span class='no'>design</span>, <span class='no'>i</span>)
        <span class='no'>c</span> <span class='kw'>&lt;-</span> <span class='no'>c</span> + <span class='fl'>1</span>
    }
    <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>dist.list</span>) <span class='kw'>&lt;-</span> <span class='no'>groups</span>
    <span class='fu'><a href='https://rdrr.io/r/base/invisible.html'>invisible</a></span>(<span class='no'>dist.list</span>)
  }</div><div class='output co'>#&gt; function (dist, design, groups) 
#&gt; {
#&gt;     if (length(groups) == 1) {
#&gt;         options(warn = (-1))
#&gt;         if (groups == "all") {
#&gt;             if (length(design) == 1) {
#&gt;                 dsn &lt;- read.table(design)
#&gt;             }
#&gt;             if (length(design) &gt; 1) {
#&gt;                 dsn &lt;- design
#&gt;             }
#&gt;             groups &lt;- as.vector(unique(dsn[, 2]))
#&gt;             options(warn = (0))
#&gt;         }
#&gt;     }
#&gt;     one.within &lt;- function(dist, design, group) {
#&gt;         if (typeof(dist) == "character") {
#&gt;             dist &lt;- read.dist(dist)
#&gt;         }
#&gt;         if (length(design) == 1) {
#&gt;             design &lt;- read.design(design)
#&gt;         }
#&gt;         get.dists &lt;- function(dist, design, group1, group2) {
#&gt;             get.grp1 &lt;- function(d, g) {
#&gt;                 c1 &lt;- 1
#&gt;                 grp1 &lt;- c()
#&gt;                 for (i in 1:nrow(d)) {
#&gt;                   if (d[i, 2] == g) {
#&gt;                     grp1[c1] &lt;- d[i, 1]
#&gt;                     c1 &lt;- c1 + 1
#&gt;                   }
#&gt;                 }
#&gt;                 invisible(grp1)
#&gt;             }
#&gt;             get.grp2 &lt;- function(d, g) {
#&gt;                 c2 &lt;- 1
#&gt;                 grp2 &lt;- c()
#&gt;                 for (i in 1:nrow(d)) {
#&gt;                   if (d[i, 2] == g) {
#&gt;                     grp2[c2] &lt;- d[i, 1]
#&gt;                     c2 &lt;- c2 + 1
#&gt;                   }
#&gt;                 }
#&gt;                 invisible(grp2)
#&gt;             }
#&gt;             grp1 &lt;- get.grp1(design, group1)
#&gt;             grp2 &lt;- get.grp2(design, group2)
#&gt;             get.rows &lt;- function(dist, grp) {
#&gt;                 rows &lt;- dist[grp[1], ]
#&gt;                 for (i in 2:length(grp)) {
#&gt;                   rows &lt;- rbind(rows, dist[grp[i], ])
#&gt;                 }
#&gt;                 invisible(rows)
#&gt;             }
#&gt;             rows &lt;- get.rows(dist, grp1)
#&gt;             get.rows &lt;- function(dist, grp) {
#&gt;                 matrix &lt;- dist[, grp[1]]
#&gt;                 for (i in 2:length(grp)) {
#&gt;                   matrix &lt;- cbind(matrix, dist[, grp[i]])
#&gt;                 }
#&gt;                 invisible(matrix)
#&gt;             }
#&gt;             matrix &lt;- get.rows(rows, grp2)
#&gt;             vect &lt;- as.vector(matrix)
#&gt;             invisible(vect)
#&gt;         }
#&gt;         dists &lt;- get.dists(dist, design, group, group)
#&gt;         rm.duplicates &lt;- function(dists) {
#&gt;             square &lt;- matrix(dists, nrow = sqrt(length(dists)))
#&gt;             half.dists &lt;- c()
#&gt;             half.dists[1] &lt;- square[2, 1]
#&gt;             for (i in 3:ncol(square)) {
#&gt;                 keepers &lt;- square[i, 1:(i - 1)]
#&gt;                 half.dists[(length(half.dists) + 1):(length(half.dists) + 
#&gt;                   length(keepers))] &lt;- keepers
#&gt;             }
#&gt;             invisible(half.dists)
#&gt;         }
#&gt;         lt.dist &lt;- rm.duplicates(dists)
#&gt;         cat(sprintf("Stats for distances within %s", group), 
#&gt;             "\n", sprintf("Minimum: %f", min(lt.dist)), "\n", 
#&gt;             sprintf("Maximum: %f", min(lt.dist)), "\n", sprintf("Median: %f", 
#&gt;                 median(lt.dist)), "\n", sprintf("Mean: %f", mean(lt.dist)), 
#&gt;             "\n", sprintf("Std. Dev.: %f", sd(lt.dist)), "\n", 
#&gt;             "\n", sep = "")
#&gt;         invisible(lt.dist)
#&gt;     }
#&gt;     dist.vect &lt;- c()
#&gt;     c &lt;- 1
#&gt;     dist.list &lt;- vector(mode = "list", length = length(groups))
#&gt;     for (i in groups) {
#&gt;         dist.list[[c]] &lt;- one.within(dist, design, i)
#&gt;         c &lt;- c + 1
#&gt;     }
#&gt;     names(dist.list) &lt;- groups
#&gt;     invisible(dist.list)
#&gt;   }
#&gt; &lt;environment: 0x7fad4e784a10&gt;</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Kelly Sovacool, Nick Lesniak, Andrew Hannah, Nielson Baxter, Alyxandria Schubert, Kathryn Iverson, Patrick Schloss.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


